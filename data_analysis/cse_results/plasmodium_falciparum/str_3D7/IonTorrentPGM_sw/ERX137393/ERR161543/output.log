## Starting pipeline #
bio_pipeline.sh -ref complete.fasta -sra /home/fabio/ncbi/public/sra/ERR161543.sra -sw -nofix -dbq 0 -fs -skip-fastqc
######################

## Saving SRA statistics..
## Dumping fastq files from /home/fabio/ncbi/public/sra/ERR161543.sra
Read 1959564 spots for /home/fabio/ncbi/public/sra/ERR161543.sra
Written 1959564 spots for /home/fabio/ncbi/public/sra/ERR161543.sra
## Two fastq files generated
## Removing 1st fastq, using only 2nd
## Creating bwa index for complete.fasta
[bwa_index] Pack FASTA... 0.15 sec
[bwa_index] Construct BWT for the packed sequence...
[bwa_index] 5.70 seconds elapse.
[bwa_index] Update BWT... 0.11 sec
[bwa_index] Pack forward-only FASTA... 0.09 sec
[bwa_index] Construct SA from BWT and Occ... 4.57 sec
[main] Version: 0.7.12-r1039
[main] CMD: bwa index complete.fasta
[main] Real time: 13.398 sec; CPU: 10.624 sec
## Generating sam file with bwa-sw aligner
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bsw2_aln] read 258912 sequences/pairs (40000017 bp) ...
[bsw2_aln] read 260108 sequences/pairs (40000237 bp) ...
[bsw2_aln] read 261326 sequences/pairs (40000081 bp) ...
[bsw2_aln] read 260806 sequences/pairs (40000287 bp) ...
[bsw2_aln] read 261188 sequences/pairs (40000139 bp) ...
[bsw2_aln] read 263192 sequences/pairs (40000161 bp) ...
[bsw2_aln] read 263722 sequences/pairs (40000088 bp) ...
[bsw2_aln] read 130310 sequences/pairs (19899357 bp) ...
[main] Version: 0.7.12-r1039
[main] CMD: bwa bwasw -t 4 complete.fasta ERR161543.fastq
[main] Real time: 475.220 sec; CPU: 1122.725 sec
## Converting sam file to BAM, sorting and indexing
[samopen] SAM header is present: 14 sequences.
[bam_sort_core] merging from 2 files...
## Removing duplicates
[bam_rmdup_core] processing reference ch1...
[bam_rmdup_core] processing reference ch2...
[bam_rmdup_core] processing reference ch3...
[bam_rmdup_core] processing reference ch4...
[bam_rmdup_core] processing reference ch5...
[bam_rmdup_core] processing reference ch6...
[bam_rmdup_core] processing reference ch7...
[bam_rmdup_core] processing reference ch8...
[bam_rmdup_core] processing reference ch9...
[bam_rmdup_core] processing reference ch10...
[bam_rmdup_core] processing reference ch11...
[bam_rmdup_core] processing reference ch12...
[bam_rmdup_core] processing reference ch13...
[bam_rmdup_core] processing reference ch14...
## Adding read groups and indexing
[Wed Jun 24 19:03:17 CEST 2015] picard.sam.AddOrReplaceReadGroups INPUT=tmp.rmdup.sorted.bam OUTPUT=tmp.addrg.rmdup.sorted.bam RGLB=rglib RGPL=rgpl RGPU=rgpu RGSM=rgsm VALIDATION_STRINGENCY=SILENT    RGID=1 VERBOSITY=INFO QUIET=false COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 19:03:17 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
INFO	2015-06-24 19:03:17	AddOrReplaceReadGroups	Created read group ID=1 PL=rgpl LB=rglib SM=rgsm

INFO	2015-06-24 19:03:41	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:24s.  Time for last 1,000,000:   24s.  Last read position: ch11:1,714,095
INFO	2015-06-24 19:04:00	AddOrReplaceReadGroups	Processed     2,000,000 records.  Elapsed time: 00:00:43s.  Time for last 1,000,000:   19s.  Last read position: */*
[Wed Jun 24 19:04:01 CEST 2015] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.74 minutes.
Runtime.totalMemory()=289406976
## Realigning near indels and re-indexing
[Wed Jun 24 19:04:06 CEST 2015] picard.sam.CreateSequenceDictionary REFERENCE=complete.fasta OUTPUT=complete.dict    TRUNCATE_NAMES_AT_WHITESPACE=true NUM_SEQUENCES=2147483647 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 19:04:06 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
[Wed Jun 24 19:04:06 CEST 2015] picard.sam.CreateSequenceDictionary done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=251133952
INFO  19:04:08,538 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:08,540 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  19:04:08,540 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  19:04:08,540 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  19:04:08,543 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T RealignerTargetCreator -o help.intervals -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  19:04:08,545 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  19:04:08,545 HelpFormatter - Date/Time: 2015/06/24 19:04:08 
INFO  19:04:08,545 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:08,545 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:09,105 GenomeAnalysisEngine - Strictness is SILENT 
INFO  19:04:09,220 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 1000 
INFO  19:04:09,255 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  19:04:09,279 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  19:04:09,390 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  19:04:09,402 GenomeAnalysisEngine - Done preparing for traversal 
INFO  19:04:09,403 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  19:04:09,403 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  19:04:09,403 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  19:04:39,405 ProgressMeter -    ch12:1972981   1.6771464E7    30.0 s       1.0 s       72.1%    41.0 s      11.0 s 
INFO  19:04:50,116 ProgressMeter -            done   2.3264338E7    40.0 s       1.0 s      100.0%    40.0 s       0.0 s 
INFO  19:04:50,117 ProgressMeter - Total runtime 40.71 secs, 0.68 min, 0.01 hours 
INFO  19:04:50,121 MicroScheduler - 75041 reads were filtered out during the traversal out of approximately 1586156 total reads (4.73%) 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  19:04:50,122 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  19:04:50,123 MicroScheduler -   -> 75041 reads (4.73% of total) failing MappingQualityZeroFilter 
INFO  19:04:50,123 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  19:04:50,123 MicroScheduler -   -> 0 reads (0.00% of total) failing Platform454Filter 
INFO  19:04:50,123 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  19:04:51,505 GATKRunReport - Uploaded run statistics report to AWS S3 
INFO  19:04:53,990 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:53,992 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  19:04:53,992 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  19:04:53,992 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  19:04:53,995 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T IndelRealigner -targetIntervals help.intervals -o ERR161543.bam -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores --defaultBaseQualities 0 
INFO  19:04:53,997 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  19:04:53,997 HelpFormatter - Date/Time: 2015/06/24 19:04:53 
INFO  19:04:53,997 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:53,997 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:04:54,655 GenomeAnalysisEngine - Strictness is SILENT 
INFO  19:04:54,722 GenomeAnalysisEngine - Downsampling Settings: No downsampling 
INFO  19:04:54,727 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  19:04:54,747 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  19:04:54,853 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  19:04:54,856 GenomeAnalysisEngine - Done preparing for traversal 
INFO  19:04:54,856 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  19:04:54,857 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  19:04:54,857 ProgressMeter -        Location |     reads | elapsed |     reads | completed | runtime |   runtime 
INFO  19:04:55,055 ReadShardBalancer$1 - Loading BAM index data 
INFO  19:04:55,056 ReadShardBalancer$1 - Done loading BAM index data 
INFO  19:05:24,877 ProgressMeter -      ch2:481031     47227.0    30.0 s      10.6 m        4.8%    10.3 m       9.8 m 
INFO  19:05:54,878 ProgressMeter -      ch4:776020    189827.0    60.0 s       5.3 m       14.7%     6.8 m       5.8 m 
INFO  19:06:24,879 ProgressMeter -      ch6:108701    364880.0    90.0 s       4.1 m       22.8%     6.6 m       5.1 m 
INFO  19:07:04,880 ProgressMeter -      ch8:193879    563199.0     2.2 m       3.8 m       35.7%     6.1 m       3.9 m 
INFO  19:07:34,880 ProgressMeter -     ch9:1319471    658401.0     2.7 m       4.1 m       46.7%     5.7 m       3.0 m 
INFO  19:08:04,881 ProgressMeter -     ch11:503604    888587.0     3.2 m       3.6 m       57.0%     5.6 m       2.4 m 
INFO  19:08:44,882 ProgressMeter -    ch12:1411515   1021718.0     3.8 m       3.8 m       69.7%     5.5 m      99.0 s 
INFO  19:09:14,893 ProgressMeter -    ch13:1385567   1174324.0     4.3 m       3.7 m       79.4%     5.5 m      67.0 s 
INFO  19:09:44,893 ProgressMeter -    ch14:1216788   1367494.0     4.8 m       3.5 m       91.1%     5.3 m      28.0 s 
INFO  19:10:14,909 ProgressMeter -    ch14:3291658   1567496.0     5.3 m       3.4 m      100.0%     5.3 m       0.0 s 
INFO  19:10:21,144 ProgressMeter -            done   2054290.0     5.4 m       2.6 m      100.0%     5.4 m       0.0 s 
INFO  19:10:21,144 ProgressMeter - Total runtime 326.29 secs, 5.44 min, 0.09 hours 
INFO  19:10:21,147 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 2054356 total reads (0.00%) 
INFO  19:10:21,147 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  19:10:21,147 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  19:10:22,096 GATKRunReport - Uploaded run statistics report to AWS S3 

##################
# Reads coverage #
##################
(only counts reads where MAPQ >= 1)
Genome length: 23264338
min =  0
max =  130
% cov. =  80.0097
Avg. base cov. =  6.40488
Stdev base cov. =  5.73963

Reads length (MAPQ >= 1):
min-max avg stdev
31-1047 153.486 +- 20.2749

flagstats:
2054290 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 duplicates
1576780 + 0 mapped (76.76%:-nan%)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (-nan%:-nan%)
0 + 0 with itself and mate mapped
0 + 0 singletons (-nan%:-nan%)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

idxstats:
Chr	length	mapped	unmapped
ch1	643292	47227	0
ch2	947102	68926	0
ch3	1060087	73674	0
ch4	1204112	84295	0
ch5	1343552	90758	0
ch6	1418244	98914	0
ch7	1501717	99405	0
ch8	1419563	95202	0
ch9	1541723	103925	0
ch10	1687655	126261	0
ch11	2038337	133131	0
ch12	2271478	152606	0
ch13	2895605	193170	0
ch14	3291871	209286	0
*	0	0	477510

## SNP calling with GATK
INFO  19:10:54,860 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:10:54,862 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  19:10:54,862 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  19:10:54,862 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  19:10:54,864 HelpFormatter - Program Args: -ploidy 1 -I ERR161543.bam -R complete.fasta -T UnifiedGenotyper -o ERR161543-snps.vcf -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  19:10:54,866 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  19:10:54,866 HelpFormatter - Date/Time: 2015/06/24 19:10:54 
INFO  19:10:54,867 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:10:54,867 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  19:10:55,243 GenomeAnalysisEngine - Strictness is SILENT 
INFO  19:10:55,339 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 250 
INFO  19:10:55,344 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  19:10:55,395 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.05 
INFO  19:10:55,442 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  19:10:55,454 GenomeAnalysisEngine - Done preparing for traversal 
INFO  19:10:55,454 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  19:10:55,454 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  19:10:55,455 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  19:10:55,477 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  19:10:55,477 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  19:11:25,470 ProgressMeter -      ch4:471953   3109233.0    30.0 s       9.0 s       13.4%     3.7 m       3.2 m 
INFO  19:11:55,470 ProgressMeter -     ch6:1021809   6213953.0    60.0 s       9.0 s       26.7%     3.7 m       2.7 m 
INFO  19:12:25,471 ProgressMeter -     ch8:1258885   9363290.0    90.0 s       9.0 s       40.3%     3.7 m       2.2 m 
INFO  19:12:55,485 ProgressMeter -     ch10:966173   1.2029664E7   120.0 s       9.0 s       51.8%     3.9 m     111.0 s 
INFO  19:13:25,486 ProgressMeter -    ch11:1657885   1.4421831E7     2.5 m      10.0 s       62.0%     4.0 m      91.0 s 
INFO  19:13:55,509 ProgressMeter -    ch12:1767989   1.6558472E7     3.0 m      10.0 s       71.2%     4.2 m      72.0 s 
INFO  19:14:25,510 ProgressMeter -    ch13:2057701   1.9124862E7     3.5 m      10.0 s       82.2%     4.3 m      45.0 s 
INFO  19:15:05,510 ProgressMeter -    ch14:2329429   2.2298995E7     4.2 m      11.0 s       95.9%     4.3 m      10.0 s 
INFO  19:15:14,859 ProgressMeter -            done   2.3264338E7     4.3 m      11.0 s      100.0%     4.3 m       0.0 s 
INFO  19:15:14,859 ProgressMeter - Total runtime 259.41 secs, 4.32 min, 0.07 hours 
INFO  19:15:14,860 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 1586090 total reads (0.00%) 
INFO  19:15:14,860 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  19:15:14,860 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  19:15:14,860 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  19:15:14,861 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  19:15:14,861 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  19:15:14,861 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  19:15:14,861 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  19:15:14,861 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  19:15:15,787 GATKRunReport - Uploaded run statistics report to AWS S3 
SNPs found: 268
