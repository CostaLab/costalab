## Starting pipeline #
bio_pipeline.sh -ref complete.fasta -sra /home/fabio/ncbi/public/sra/ERR161539.sra -sw -nofix -dbq 0 -fs -skip-fastqc
######################

## Saving SRA statistics..
## Dumping fastq files from /home/fabio/ncbi/public/sra/ERR161539.sra
Read 1636684 spots for /home/fabio/ncbi/public/sra/ERR161539.sra
Written 1636684 spots for /home/fabio/ncbi/public/sra/ERR161539.sra
## Two fastq files generated
## Removing 1st fastq, using only 2nd
## Creating bwa index for complete.fasta
[bwa_index] Pack FASTA... 0.15 sec
[bwa_index] Construct BWT for the packed sequence...
[bwa_index] 5.90 seconds elapse.
[bwa_index] Update BWT... 0.13 sec
[bwa_index] Pack forward-only FASTA... 0.11 sec
[bwa_index] Construct SA from BWT and Occ... 4.99 sec
[main] Version: 0.7.12-r1039
[main] CMD: bwa index complete.fasta
[main] Real time: 22.812 sec; CPU: 11.289 sec
## Generating sam file with bwa-sw aligner
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bsw2_aln] read 265770 sequences/pairs (40000178 bp) ...
[bsw2_aln] read 263828 sequences/pairs (40000037 bp) ...
[bsw2_aln] read 269942 sequences/pairs (40000197 bp) ...
[bsw2_aln] read 275912 sequences/pairs (40000142 bp) ...
[bsw2_aln] read 262630 sequences/pairs (40000047 bp) ...
[bsw2_aln] read 262508 sequences/pairs (40000016 bp) ...
[bsw2_aln] read 36094 sequences/pairs (5503791 bp) ...
[main] Version: 0.7.12-r1039
[main] CMD: bwa bwasw -t 4 complete.fasta ERR161539.fastq
[main] Real time: 438.238 sec; CPU: 1034.286 sec
## Converting sam file to BAM, sorting and indexing
[samopen] SAM header is present: 14 sequences.
[bam_sort_core] merging from 2 files...
## Removing duplicates
[bam_rmdup_core] processing reference ch1...
[bam_rmdup_core] processing reference ch2...
[bam_rmdup_core] processing reference ch3...
[bam_rmdup_core] processing reference ch4...
[bam_rmdup_core] processing reference ch5...
[bam_rmdup_core] processing reference ch6...
[bam_rmdup_core] processing reference ch7...
[bam_rmdup_core] processing reference ch8...
[bam_rmdup_core] processing reference ch9...
[bam_rmdup_core] processing reference ch10...
[bam_rmdup_core] processing reference ch11...
[bam_rmdup_core] processing reference ch12...
[bam_rmdup_core] processing reference ch13...
[bam_rmdup_core] processing reference ch14...
## Adding read groups and indexing
[Wed Jun 24 17:45:03 CEST 2015] picard.sam.AddOrReplaceReadGroups INPUT=tmp.rmdup.sorted.bam OUTPUT=tmp.addrg.rmdup.sorted.bam RGLB=rglib RGPL=rgpl RGPU=rgpu RGSM=rgsm VALIDATION_STRINGENCY=SILENT    RGID=1 VERBOSITY=INFO QUIET=false COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 17:45:03 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
INFO	2015-06-24 17:45:03	AddOrReplaceReadGroups	Created read group ID=1 PL=rgpl LB=rglib SM=rgsm

INFO	2015-06-24 17:45:23	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:19s.  Time for last 1,000,000:   19s.  Last read position: ch12:983,981
[Wed Jun 24 17:45:39 CEST 2015] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.59 minutes.
Runtime.totalMemory()=282066944
## Realigning near indels and re-indexing
[Wed Jun 24 17:45:43 CEST 2015] picard.sam.CreateSequenceDictionary REFERENCE=complete.fasta OUTPUT=complete.dict    TRUNCATE_NAMES_AT_WHITESPACE=true NUM_SEQUENCES=2147483647 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 17:45:43 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
[Wed Jun 24 17:45:44 CEST 2015] picard.sam.CreateSequenceDictionary done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=251133952
INFO  17:45:46,612 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:45:46,614 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  17:45:46,614 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  17:45:46,614 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  17:45:46,616 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T RealignerTargetCreator -o help.intervals -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  17:45:46,618 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  17:45:46,618 HelpFormatter - Date/Time: 2015/06/24 17:45:46 
INFO  17:45:46,619 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:45:46,619 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:45:47,110 GenomeAnalysisEngine - Strictness is SILENT 
INFO  17:45:47,244 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 1000 
INFO  17:45:47,262 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  17:45:47,282 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  17:45:47,357 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  17:45:47,401 GenomeAnalysisEngine - Done preparing for traversal 
INFO  17:45:47,402 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  17:45:47,402 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  17:45:47,402 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  17:46:17,426 ProgressMeter -     ch13:451969   1.751923E7    30.0 s       1.0 s       75.3%    39.0 s       9.0 s 
INFO  17:46:26,001 ProgressMeter -            done   2.3264338E7    38.0 s       1.0 s      100.0%    38.0 s       0.0 s 
INFO  17:46:26,001 ProgressMeter - Total runtime 38.60 secs, 0.64 min, 0.01 hours 
INFO  17:46:26,003 MicroScheduler - 85627 reads were filtered out during the traversal out of approximately 1414389 total reads (6.05%) 
INFO  17:46:26,003 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  17:46:26,003 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  17:46:26,004 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  17:46:26,004 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  17:46:26,004 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  17:46:26,004 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  17:46:26,004 MicroScheduler -   -> 85627 reads (6.05% of total) failing MappingQualityZeroFilter 
INFO  17:46:26,004 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  17:46:26,005 MicroScheduler -   -> 0 reads (0.00% of total) failing Platform454Filter 
INFO  17:46:26,005 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  17:46:27,122 GATKRunReport - Uploaded run statistics report to AWS S3 
INFO  17:46:29,038 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:46:29,039 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  17:46:29,039 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  17:46:29,039 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  17:46:29,042 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T IndelRealigner -targetIntervals help.intervals -o ERR161539.bam -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores --defaultBaseQualities 0 
INFO  17:46:29,044 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  17:46:29,044 HelpFormatter - Date/Time: 2015/06/24 17:46:29 
INFO  17:46:29,044 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:46:29,044 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:46:29,598 GenomeAnalysisEngine - Strictness is SILENT 
INFO  17:46:29,729 GenomeAnalysisEngine - Downsampling Settings: No downsampling 
INFO  17:46:29,735 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  17:46:29,755 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  17:46:29,827 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  17:46:29,830 GenomeAnalysisEngine - Done preparing for traversal 
INFO  17:46:29,831 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  17:46:29,831 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  17:46:29,831 ProgressMeter -        Location |     reads | elapsed |     reads | completed | runtime |   runtime 
INFO  17:46:30,071 ReadShardBalancer$1 - Loading BAM index data 
INFO  17:46:30,072 ReadShardBalancer$1 - Done loading BAM index data 
INFO  17:46:59,844 ProgressMeter -      ch2:739250     50052.0    30.0 s      10.0 m        5.9%     8.4 m       7.9 m 
INFO  17:47:29,853 ProgressMeter -      ch4:183727    182614.0    60.0 s       5.5 m       12.2%     8.2 m       7.2 m 
INFO  17:47:59,885 ProgressMeter -      ch5:700509    266928.0    90.0 s       5.6 m       19.6%     7.7 m       6.2 m 
INFO  17:48:29,886 ProgressMeter -     ch6:1177008    347968.0   120.0 s       5.8 m       27.4%     7.3 m       5.3 m 
INFO  17:48:59,909 ProgressMeter -      ch8:184051    527847.0     2.5 m       4.7 m       35.7%     7.0 m       4.5 m 
INFO  17:49:39,910 ProgressMeter -      ch9:995863    613927.0     3.2 m       5.2 m       45.3%     7.0 m       3.8 m 
INFO  17:50:09,911 ProgressMeter -    ch10:1286325    706751.0     3.7 m       5.2 m       53.2%     6.9 m       3.2 m 
INFO  17:50:39,912 ProgressMeter -    ch11:1553285    829191.0     4.2 m       5.0 m       61.6%     6.8 m       2.6 m 
INFO  17:51:09,912 ProgressMeter -    ch12:1168609    941911.0     4.7 m       5.0 m       68.7%     6.8 m       2.1 m 
INFO  17:51:39,913 ProgressMeter -     ch13:850107   1077997.0     5.2 m       4.8 m       77.1%     6.7 m      92.0 s 
INFO  17:52:19,914 ProgressMeter -     ch14:663743   1239759.0     5.8 m       4.7 m       88.7%     6.6 m      44.0 s 
INFO  17:52:49,914 ProgressMeter -    ch14:2353880   1339761.0     6.3 m       4.7 m       96.0%     6.6 m      15.0 s 
INFO  17:53:09,262 ProgressMeter -            done   1717374.0     6.7 m       3.9 m      100.0%     6.7 m       0.0 s 
INFO  17:53:09,263 ProgressMeter - Total runtime 399.43 secs, 6.66 min, 0.11 hours 
INFO  17:53:09,271 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 1717414 total reads (0.00%) 
INFO  17:53:09,272 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  17:53:09,272 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  17:53:10,196 GATKRunReport - Uploaded run statistics report to AWS S3 

##################
# Reads coverage #
##################
(only counts reads where MAPQ >= 1)
Genome length: 23264338
min =  0
max =  184
% cov. =  57.7048
Avg. base cov. =  6.1101
Stdev base cov. =  8.56037

Reads length (MAPQ >= 1):
min-max avg stdev
31-546 150.714 +- 16.0721

flagstats:
1717374 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 duplicates
1405377 + 0 mapped (81.83%:-nan%)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (-nan%:-nan%)
0 + 0 with itself and mate mapped
0 + 0 singletons (-nan%:-nan%)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

idxstats:
Chr	length	mapped	unmapped
ch1	643292	50052	0
ch2	947102	64023	0
ch3	1060087	68539	0
ch4	1204112	84314	0
ch5	1343552	81040	0
ch6	1418244	89876	0
ch7	1501717	90003	0
ch8	1419563	86080	0
ch9	1541723	92824	0
ch10	1687655	122440	0
ch11	2038337	112720	0
ch12	2271478	136086	0
ch13	2895605	161762	0
ch14	3291871	165618	0
*	0	0	311997

## SNP calling with GATK
INFO  17:53:32,099 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:53:32,100 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  17:53:32,100 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  17:53:32,101 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  17:53:32,103 HelpFormatter - Program Args: -ploidy 1 -I ERR161539.bam -R complete.fasta -T UnifiedGenotyper -o ERR161539-snps.vcf -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  17:53:32,105 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  17:53:32,105 HelpFormatter - Date/Time: 2015/06/24 17:53:32 
INFO  17:53:32,105 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:53:32,105 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  17:53:32,452 GenomeAnalysisEngine - Strictness is SILENT 
INFO  17:53:32,572 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 250 
INFO  17:53:32,577 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  17:53:32,596 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  17:53:32,639 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  17:53:32,678 GenomeAnalysisEngine - Done preparing for traversal 
INFO  17:53:32,678 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  17:53:32,678 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  17:53:32,678 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  17:53:32,701 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  17:53:32,702 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  17:54:02,702 ProgressMeter -      ch4:589341   3223921.0    30.0 s       9.0 s       13.9%     3.6 m       3.1 m 
INFO  17:54:32,702 ProgressMeter -      ch7:949189   7550277.0    60.0 s       7.0 s       32.5%     3.1 m       2.1 m 
INFO  17:55:02,703 ProgressMeter -     ch10:901037   1.1964128E7    90.0 s       7.0 s       51.5%     2.9 m      84.0 s 
INFO  17:55:32,704 ProgressMeter -    ch12:1579965   1.6378248E7   120.0 s       7.0 s       70.4%     2.8 m      50.0 s 
INFO  17:56:02,709 ProgressMeter -      ch14:76637   2.0038003E7     2.5 m       7.0 s       86.2%     2.9 m      24.0 s 
INFO  17:56:32,749 ProgressMeter -    ch14:3093693   2.3052659E7     3.0 m       7.0 s       99.1%     3.0 m       1.0 s 
INFO  17:56:34,417 ProgressMeter -            done   2.3264338E7     3.0 m       7.0 s      100.0%     3.0 m       0.0 s 
INFO  17:56:34,418 ProgressMeter - Total runtime 181.74 secs, 3.03 min, 0.05 hours 
INFO  17:56:34,418 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 1414349 total reads (0.00%) 
INFO  17:56:34,418 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  17:56:34,418 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  17:56:34,418 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  17:56:34,419 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  17:56:34,419 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  17:56:34,419 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  17:56:34,419 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  17:56:34,419 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  17:56:35,390 GATKRunReport - Uploaded run statistics report to AWS S3 
SNPs found: 214
