## Starting pipeline #
bio_pipeline.sh -ref complete.fasta -sra /home/fabio/ncbi/public/sra/ERR161540.sra -sw -nofix -dbq 0 -fs -skip-fastqc
######################

## Saving SRA statistics..
## Dumping fastq files from /home/fabio/ncbi/public/sra/ERR161540.sra
Read 1805550 spots for /home/fabio/ncbi/public/sra/ERR161540.sra
Written 1805550 spots for /home/fabio/ncbi/public/sra/ERR161540.sra
## Two fastq files generated
## Removing 1st fastq, using only 2nd
## Creating bwa index for complete.fasta
[bwa_index] Pack FASTA... 0.14 sec
[bwa_index] Construct BWT for the packed sequence...
[bwa_index] 6.06 seconds elapse.
[bwa_index] Update BWT... 0.10 sec
[bwa_index] Pack forward-only FASTA... 0.08 sec
[bwa_index] Construct SA from BWT and Occ... 4.80 sec
[main] Version: 0.7.12-r1039
[main] CMD: bwa index complete.fasta
[main] Real time: 15.759 sec; CPU: 11.189 sec
## Generating sam file with bwa-sw aligner
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bsw2_aln] read 272874 sequences/pairs (40000304 bp) ...
[bsw2_aln] read 261772 sequences/pairs (40000139 bp) ...
[bsw2_aln] read 271422 sequences/pairs (40000111 bp) ...
[bsw2_aln] read 276814 sequences/pairs (40000150 bp) ...
[bsw2_aln] read 263588 sequences/pairs (40000288 bp) ...
[bsw2_aln] read 260654 sequences/pairs (40000051 bp) ...
[bsw2_aln] read 198426 sequences/pairs (30110917 bp) ...
[main] Version: 0.7.12-r1039
[main] CMD: bwa bwasw -t 4 complete.fasta ERR161540.fastq
[main] Real time: 480.435 sec; CPU: 1124.018 sec
## Converting sam file to BAM, sorting and indexing
[samopen] SAM header is present: 14 sequences.
[bam_sort_core] merging from 2 files...
## Removing duplicates
[bam_rmdup_core] processing reference ch1...
[bam_rmdup_core] processing reference ch2...
[bam_rmdup_core] processing reference ch3...
[bam_rmdup_core] processing reference ch4...
[bam_rmdup_core] processing reference ch5...
[bam_rmdup_core] processing reference ch6...
[bam_rmdup_core] processing reference ch7...
[bam_rmdup_core] processing reference ch8...
[bam_rmdup_core] processing reference ch9...
[bam_rmdup_core] processing reference ch10...
[bam_rmdup_core] processing reference ch11...
[bam_rmdup_core] processing reference ch12...
[bam_rmdup_core] processing reference ch13...
[bam_rmdup_core] processing reference ch14...
## Adding read groups and indexing
[Wed Jun 24 18:07:37 CEST 2015] picard.sam.AddOrReplaceReadGroups INPUT=tmp.rmdup.sorted.bam OUTPUT=tmp.addrg.rmdup.sorted.bam RGLB=rglib RGPL=rgpl RGPU=rgpu RGSM=rgsm VALIDATION_STRINGENCY=SILENT    RGID=1 VERBOSITY=INFO QUIET=false COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 18:07:37 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
INFO	2015-06-24 18:07:38	AddOrReplaceReadGroups	Created read group ID=1 PL=rgpl LB=rglib SM=rgsm

INFO	2015-06-24 18:07:56	AddOrReplaceReadGroups	Processed     1,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:   18s.  Last read position: ch11:2,032,594
[Wed Jun 24 18:08:15 CEST 2015] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.63 minutes.
Runtime.totalMemory()=343408640
## Realigning near indels and re-indexing
[Wed Jun 24 18:08:19 CEST 2015] picard.sam.CreateSequenceDictionary REFERENCE=complete.fasta OUTPUT=complete.dict    TRUNCATE_NAMES_AT_WHITESPACE=true NUM_SEQUENCES=2147483647 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Wed Jun 24 18:08:19 CEST 2015] Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15; Picard version: 1.134(a7a08c474e4d99346eec7a9956a8fe71943b5d80_1434033355) IntelDeflater
[Wed Jun 24 18:08:20 CEST 2015] picard.sam.CreateSequenceDictionary done. Elapsed time: 0.01 minutes.
Runtime.totalMemory()=251133952
INFO  18:08:22,223 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:08:22,224 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  18:08:22,225 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  18:08:22,225 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  18:08:22,227 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T RealignerTargetCreator -o help.intervals -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  18:08:22,229 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  18:08:22,229 HelpFormatter - Date/Time: 2015/06/24 18:08:22 
INFO  18:08:22,229 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:08:22,230 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:08:22,662 GenomeAnalysisEngine - Strictness is SILENT 
INFO  18:08:22,723 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 1000 
INFO  18:08:22,762 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  18:08:22,796 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.03 
INFO  18:08:22,842 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  18:08:22,887 GenomeAnalysisEngine - Done preparing for traversal 
INFO  18:08:22,887 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  18:08:22,887 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  18:08:22,888 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  18:08:52,910 ProgressMeter -     ch13:706513   1.7781374E7    30.0 s       1.0 s       76.4%    39.0 s       9.0 s 
INFO  18:09:00,264 ProgressMeter -            done   2.3264338E7    37.0 s       1.0 s      100.0%    37.0 s       0.0 s 
INFO  18:09:00,264 ProgressMeter - Total runtime 37.38 secs, 0.62 min, 0.01 hours 
INFO  18:09:00,266 MicroScheduler - 91123 reads were filtered out during the traversal out of approximately 1503530 total reads (6.06%) 
INFO  18:09:00,266 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  18:09:00,267 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  18:09:00,267 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  18:09:00,267 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  18:09:00,267 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  18:09:00,267 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  18:09:00,268 MicroScheduler -   -> 91123 reads (6.06% of total) failing MappingQualityZeroFilter 
INFO  18:09:00,268 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  18:09:00,268 MicroScheduler -   -> 0 reads (0.00% of total) failing Platform454Filter 
INFO  18:09:00,268 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  18:09:01,316 GATKRunReport - Uploaded run statistics report to AWS S3 
INFO  18:09:02,773 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:09:02,775 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  18:09:02,775 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  18:09:02,775 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  18:09:02,778 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R complete.fasta -T IndelRealigner -targetIntervals help.intervals -o ERR161540.bam -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores --defaultBaseQualities 0 
INFO  18:09:02,780 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  18:09:02,780 HelpFormatter - Date/Time: 2015/06/24 18:09:02 
INFO  18:09:02,780 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:09:02,780 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:09:03,172 GenomeAnalysisEngine - Strictness is SILENT 
INFO  18:09:03,272 GenomeAnalysisEngine - Downsampling Settings: No downsampling 
INFO  18:09:03,277 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  18:09:03,298 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  18:09:03,344 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  18:09:03,347 GenomeAnalysisEngine - Done preparing for traversal 
INFO  18:09:03,348 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  18:09:03,348 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  18:09:03,348 ProgressMeter -        Location |     reads | elapsed |     reads | completed | runtime |   runtime 
INFO  18:09:03,506 ReadShardBalancer$1 - Loading BAM index data 
INFO  18:09:03,507 ReadShardBalancer$1 - Done loading BAM index data 
INFO  18:09:33,350 ProgressMeter -      ch2:541489     53172.0    30.0 s       9.4 m        5.1%     9.8 m       9.3 m 
INFO  18:10:03,351 ProgressMeter -       ch4:17954    194367.0    60.0 s       5.1 m       11.5%     8.7 m       7.7 m 
INFO  18:10:33,361 ProgressMeter -      ch5:581688    283468.0    90.0 s       5.3 m       19.1%     7.9 m       6.4 m 
INFO  18:11:03,361 ProgressMeter -      ch6:577022    368867.0   120.0 s       5.4 m       24.8%     8.1 m       6.1 m 
INFO  18:11:33,362 ProgressMeter -      ch7:331333    465037.0     2.5 m       5.4 m       29.9%     8.4 m       5.9 m 
INFO  18:12:13,363 ProgressMeter -      ch8:776029    560274.0     3.2 m       5.7 m       38.2%     8.3 m       5.1 m 
INFO  18:12:43,373 ProgressMeter -      ch9:717295    651065.0     3.7 m       5.6 m       44.1%     8.3 m       4.7 m 
INFO  18:13:13,389 ProgressMeter -     ch10:668512    749567.0     4.2 m       5.6 m       50.5%     8.3 m       4.1 m 
INFO  18:13:53,389 ProgressMeter -     ch11:684101    880020.0     4.8 m       5.5 m       57.8%     8.4 m       3.5 m 
INFO  18:14:23,390 ProgressMeter -     ch12:181906   1000882.0     5.3 m       5.3 m       64.4%     8.3 m       2.9 m 
INFO  18:14:53,397 ProgressMeter -    ch12:1299794   1000882.0     5.8 m       5.8 m       69.2%     8.4 m       2.6 m 
INFO  18:15:33,397 ProgressMeter -    ch13:1237943   1145725.0     6.5 m       5.7 m       78.7%     8.3 m     105.0 s 
INFO  18:16:03,398 ProgressMeter -    ch13:2710957   1245726.0     7.0 m       5.6 m       85.1%     8.2 m      73.0 s 
INFO  18:16:33,399 ProgressMeter -    ch14:1325846   1318040.0     7.5 m       5.7 m       91.5%     8.2 m      41.0 s 
INFO  18:17:03,409 ProgressMeter -    ch14:2540240   1418043.0     8.0 m       5.6 m       96.8%     8.3 m      16.0 s 
INFO  18:17:32,749 ProgressMeter -            done   1889344.0     8.5 m       4.5 m      100.0%     8.5 m       0.0 s 
INFO  18:17:32,749 ProgressMeter - Total runtime 509.40 secs, 8.49 min, 0.14 hours 
INFO  18:17:32,751 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 1889395 total reads (0.00%) 
INFO  18:17:32,751 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  18:17:32,752 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  18:17:34,011 GATKRunReport - Uploaded run statistics report to AWS S3 

##################
# Reads coverage #
##################
(only counts reads where MAPQ >= 1)
Genome length: 23264338
min =  0
max =  190
% cov. =  58.3577
Avg. base cov. =  6.50116
Stdev base cov. =  9.09218

Reads length (MAPQ >= 1):
min-max avg stdev
31-992 151.228 +- 19.0371

flagstats:
1889344 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 duplicates
1494106 + 0 mapped (79.08%:-nan%)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (-nan%:-nan%)
0 + 0 with itself and mate mapped
0 + 0 singletons (-nan%:-nan%)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

idxstats:
Chr	length	mapped	unmapped
ch1	643292	53172	0
ch2	947102	68124	0
ch3	1060087	73071	0
ch4	1204112	89101	0
ch5	1343552	85399	0
ch6	1418244	96170	0
ch7	1501717	95237	0
ch8	1419563	90791	0
ch9	1541723	98502	0
ch10	1687655	130453	0
ch11	2038337	120862	0
ch12	2271478	144843	0
ch13	2895605	172315	0
ch14	3291871	176066	0
*	0	0	395238

## SNP calling with GATK
INFO  18:18:07,788 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:18:07,790 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  18:18:07,790 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  18:18:07,791 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  18:18:07,794 HelpFormatter - Program Args: -ploidy 1 -I ERR161540.bam -R complete.fasta -T UnifiedGenotyper -o ERR161540-snps.vcf -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  18:18:07,796 HelpFormatter - Executing as fabio@megalodonte on Linux 3.13.0-37-generic amd64; Java HotSpot(TM) 64-Bit Server VM 1.7.0_80-b15. 
INFO  18:18:07,796 HelpFormatter - Date/Time: 2015/06/24 18:18:07 
INFO  18:18:07,796 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:18:07,796 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  18:18:08,212 GenomeAnalysisEngine - Strictness is SILENT 
INFO  18:18:08,301 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 250 
INFO  18:18:08,360 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  18:18:08,380 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.02 
INFO  18:18:08,454 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  18:18:08,465 GenomeAnalysisEngine - Done preparing for traversal 
INFO  18:18:08,465 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  18:18:08,466 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  18:18:08,466 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  18:18:08,520 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  18:18:08,521 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  18:18:38,494 ProgressMeter -      ch3:685745   2262138.0    30.0 s      13.0 s        9.8%     5.1 m       4.6 m 
INFO  18:19:08,510 ProgressMeter -       ch6:94621   5280065.0    60.0 s      11.0 s       22.8%     4.4 m       3.4 m 
INFO  18:19:38,512 ProgressMeter -     ch7:1354089   7959877.0    90.0 s      11.0 s       34.3%     4.4 m       2.9 m 
INFO  18:20:08,529 ProgressMeter -     ch10:154657   1.1226848E7   120.0 s      10.0 s       48.3%     4.1 m       2.1 m 
INFO  18:20:38,531 ProgressMeter -    ch11:1135997   1.3897543E7     2.5 m      10.0 s       59.8%     4.2 m     100.0 s 
INFO  18:21:08,541 ProgressMeter -    ch12:2175289   1.6968072E7     3.0 m      10.0 s       73.0%     4.1 m      66.0 s 
INFO  18:21:38,542 ProgressMeter -     ch14:242777   2.0201843E7     3.5 m      10.0 s       86.9%     4.0 m      31.0 s 
INFO  18:22:06,456 ProgressMeter -            done   2.3264338E7     4.0 m      10.0 s      100.0%     4.0 m       0.0 s 
INFO  18:22:06,456 ProgressMeter - Total runtime 237.99 secs, 3.97 min, 0.07 hours 
INFO  18:22:06,456 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 1503479 total reads (0.00%) 
INFO  18:22:06,457 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  18:22:06,457 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  18:22:06,457 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  18:22:06,457 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  18:22:06,457 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  18:22:06,458 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  18:22:06,458 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  18:22:06,458 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  18:22:07,586 GATKRunReport - Uploaded run statistics report to AWS S3 
SNPs found: 183
