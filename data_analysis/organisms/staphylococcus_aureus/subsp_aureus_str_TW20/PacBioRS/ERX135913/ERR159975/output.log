## Starting pipeline #
bio_pipeline.sh -ref NC_017331.1.fasta -sra ERR159975.sra -mem-pacbio -dbq 0 -nofix -skip-fastqc -indels
######################

## Saving SRA statistics..
## Dumping fastq files from ERR159975.sra
Rejected 74959 READS because READLEN < 1
Read 81741 spots for ERR159975.sra
Written 6782 spots for ERR159975.sra
## One fastq file generated
## Creating bwa index for NC_017331.1.fasta
[bwa_index] Pack FASTA... 0.02 sec
[bwa_index] Construct BWT for the packed sequence...
[bwa_index] 0.59 seconds elapse.
[bwa_index] Update BWT... 0.02 sec
[bwa_index] Pack forward-only FASTA... 0.01 sec
[bwa_index] Construct SA from BWT and Occ... 0.28 sec
[main] Version: 0.7.12-r1039
[main] CMD: bwa index NC_017331.1.fasta
[main] Real time: 1.547 sec; CPU: 0.912 sec
## Generating sam file with bwa-mem aligner
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 6782 sequences (5231821 bp)...
[M::mem_process_seqs] Processed 6782 reads in 12.404 CPU sec, 3.108 real sec
[main] Version: 0.7.12-r1039
[main] CMD: bwa mem -t 4 -x pacbio NC_017331.1.fasta ERR159975_1.fastq
[main] Real time: 3.381 sec; CPU: 12.436 sec
## Converting sam file to BAM, sorting and indexing
[samopen] SAM header is present: 1 sequences.
## Removing duplicates
[bam_rmdup_core] processing reference gi|387141638|ref|NC_017331.1|...
## Adding read groups and indexing
[Thu Jul 02 10:57:38 CEST 2015] picard.sam.AddOrReplaceReadGroups INPUT=tmp.rmdup.sorted.bam OUTPUT=tmp.addrg.rmdup.sorted.bam RGLB=rglib RGPL=rgpl RGPU=rgpu RGSM=rgsm VALIDATION_STRINGENCY=SILENT    RGID=1 VERBOSITY=INFO QUIET=false COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Thu Jul 02 10:57:38 CEST 2015] Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14; Picard version: 1.135(83ec44e03ec8d07ef180ef86b7a62d59a80dedd3_1435607037) IntelDeflater
INFO	2015-07-02 10:57:38	AddOrReplaceReadGroups	Created read group ID=1 PL=rgpl LB=rglib SM=rgsm

[Thu Jul 02 10:57:39 CEST 2015] picard.sam.AddOrReplaceReadGroups done. Elapsed time: 0.02 minutes.
Runtime.totalMemory()=251658240
## Realigning near indels and re-indexing
[Thu Jul 02 10:57:39 CEST 2015] picard.sam.CreateSequenceDictionary REFERENCE=NC_017331.1.fasta OUTPUT=NC_017331.1.dict    TRUNCATE_NAMES_AT_WHITESPACE=true NUM_SEQUENCES=2147483647 VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json
[Thu Jul 02 10:57:39 CEST 2015] Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14; Picard version: 1.135(83ec44e03ec8d07ef180ef86b7a62d59a80dedd3_1435607037) IntelDeflater
[Thu Jul 02 10:57:39 CEST 2015] picard.sam.CreateSequenceDictionary done. Elapsed time: 0.00 minutes.
Runtime.totalMemory()=251658240
INFO  10:57:40,975 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:40,977 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  10:57:40,977 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  10:57:40,977 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  10:57:40,980 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R NC_017331.1.fasta -T RealignerTargetCreator -o help.intervals -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  10:57:40,984 HelpFormatter - Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14. 
INFO  10:57:40,984 HelpFormatter - Date/Time: 2015/07/02 10:57:40 
INFO  10:57:40,984 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:40,984 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:41,028 GenomeAnalysisEngine - Strictness is SILENT 
INFO  10:57:41,101 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 1000 
INFO  10:57:41,106 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  10:57:41,122 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.01 
INFO  10:57:41,185 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  10:57:41,215 GenomeAnalysisEngine - Done preparing for traversal 
INFO  10:57:41,215 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  10:57:41,215 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  10:57:41,216 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  10:57:43,983 ProgressMeter -            done   3043210.0     2.0 s       0.0 s      100.0%     2.0 s       0.0 s 
INFO  10:57:43,984 ProgressMeter - Total runtime 2.77 secs, 0.05 min, 0.00 hours 
INFO  10:57:43,986 MicroScheduler - 72 reads were filtered out during the traversal out of approximately 5193 total reads (1.39%) 
INFO  10:57:43,986 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  10:57:43,987 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  10:57:43,987 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  10:57:43,987 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  10:57:43,987 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  10:57:43,987 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  10:57:43,988 MicroScheduler -   -> 72 reads (1.39% of total) failing MappingQualityZeroFilter 
INFO  10:57:43,988 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  10:57:43,988 MicroScheduler -   -> 0 reads (0.00% of total) failing Platform454Filter 
INFO  10:57:43,988 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  10:57:44,899 GATKRunReport - Uploaded run statistics report to AWS S3 
INFO  10:57:46,081 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:46,083 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  10:57:46,083 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  10:57:46,083 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  10:57:46,086 HelpFormatter - Program Args: -I tmp.addrg.rmdup.sorted.bam -R NC_017331.1.fasta -T IndelRealigner -targetIntervals help.intervals -o ERR159975.bam -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores --defaultBaseQualities 0 
INFO  10:57:46,090 HelpFormatter - Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14. 
INFO  10:57:46,090 HelpFormatter - Date/Time: 2015/07/02 10:57:46 
INFO  10:57:46,090 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:46,090 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:46,192 GenomeAnalysisEngine - Strictness is SILENT 
INFO  10:57:46,224 GenomeAnalysisEngine - Downsampling Settings: No downsampling 
INFO  10:57:46,229 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  10:57:46,244 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.01 
INFO  10:57:46,301 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  10:57:46,304 GenomeAnalysisEngine - Done preparing for traversal 
INFO  10:57:46,304 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  10:57:46,305 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  10:57:46,305 ProgressMeter -        Location |     reads | elapsed |     reads | completed | runtime |   runtime 
INFO  10:57:46,321 ReadShardBalancer$1 - Loading BAM index data 
INFO  10:57:46,322 ReadShardBalancer$1 - Done loading BAM index data 
INFO  10:57:47,654 ProgressMeter -            done      6933.0     1.0 s       3.2 m       99.6%     1.0 s       0.0 s 
INFO  10:57:47,654 ProgressMeter - Total runtime 1.35 secs, 0.02 min, 0.00 hours 
INFO  10:57:47,656 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 6933 total reads (0.00%) 
INFO  10:57:47,657 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  10:57:47,657 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  10:57:48,689 GATKRunReport - Uploaded run statistics report to AWS S3 

##################
# Reads coverage #
##################
(only counts reads where MAPQ >= 1)
Genome length: 3043210
min =  0
max =  8
% cov. =  64.2349
Avg. base cov. =  1.02618
Stdev base cov. =  1.06359

Reads length (MAPQ >= 1):
min-max avg stdev
104-2887 729.092 +- 335.251

flagstats:
6933 + 0 in total (QC-passed reads + QC-failed reads)
0 + 0 duplicates
5027 + 0 mapped (72.51%:-nan%)
0 + 0 paired in sequencing
0 + 0 read1
0 + 0 read2
0 + 0 properly paired (-nan%:-nan%)
0 + 0 with itself and mate mapped
0 + 0 singletons (-nan%:-nan%)
0 + 0 with mate mapped to a different chr
0 + 0 with mate mapped to a different chr (mapQ>=5)

idxstats:
Chr	length	mapped	unmapped
gi|387141638|ref|NC_017331.1|	3043210	5027	0
*	0	0	1906

## SNP calling with GATK
INFO  10:57:51,569 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:51,570 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  10:57:51,570 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  10:57:51,571 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  10:57:51,573 HelpFormatter - Program Args: -ploidy 1 -I ERR159975.bam -R NC_017331.1.fasta -T UnifiedGenotyper -o ERR159975-snps.vcf -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  10:57:51,577 HelpFormatter - Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14. 
INFO  10:57:51,577 HelpFormatter - Date/Time: 2015/07/02 10:57:51 
INFO  10:57:51,577 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:51,577 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:57:51,642 GenomeAnalysisEngine - Strictness is SILENT 
INFO  10:57:51,708 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 250 
INFO  10:57:51,714 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  10:57:51,729 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.01 
INFO  10:57:51,788 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  10:57:51,817 GenomeAnalysisEngine - Done preparing for traversal 
INFO  10:57:51,817 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  10:57:51,818 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  10:57:51,818 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  10:57:51,845 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  10:57:51,845 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  10:58:10,745 ProgressMeter -            done   3043210.0    18.0 s       6.0 s      100.0%    18.0 s       0.0 s 
INFO  10:58:10,746 ProgressMeter - Total runtime 18.93 secs, 0.32 min, 0.01 hours 
INFO  10:58:10,746 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 5194 total reads (0.00%) 
INFO  10:58:10,746 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  10:58:10,746 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  10:58:10,747 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  10:58:10,747 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  10:58:10,747 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  10:58:10,747 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  10:58:10,747 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  10:58:10,748 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  10:58:11,657 GATKRunReport - Uploaded run statistics report to AWS S3 
SNPs found: 20
## INDELS calling with GATK
INFO  10:58:12,845 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:58:12,847 HelpFormatter - The Genome Analysis Toolkit (GATK) v3.4-0-g7e26428, Compiled 2015/05/15 03:25:41 
INFO  10:58:12,847 HelpFormatter - Copyright (c) 2010 The Broad Institute 
INFO  10:58:12,847 HelpFormatter - For support and documentation go to http://www.broadinstitute.org/gatk 
INFO  10:58:12,850 HelpFormatter - Program Args: -ploidy 1 -I ERR159975.bam -R NC_017331.1.fasta -T UnifiedGenotyper -o ERR159975-indels.vcf -glm INDEL -filterNoBases -rf BadCigar --allow_potentially_misencoded_quality_scores 
INFO  10:58:12,854 HelpFormatter - Executing as fabio@ahmad-desktop on Linux 3.19.0-22-generic amd64; OpenJDK 64-Bit Server VM 1.7.0_79-b14. 
INFO  10:58:12,854 HelpFormatter - Date/Time: 2015/07/02 10:58:12 
INFO  10:58:12,854 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:58:12,854 HelpFormatter - -------------------------------------------------------------------------------- 
INFO  10:58:12,922 GenomeAnalysisEngine - Strictness is SILENT 
INFO  10:58:12,992 GenomeAnalysisEngine - Downsampling Settings: Method: BY_SAMPLE, Target Coverage: 250 
INFO  10:58:12,997 SAMDataSource$SAMReaders - Initializing SAMRecords in serial 
INFO  10:58:13,013 SAMDataSource$SAMReaders - Done initializing BAM readers: total time 0.01 
INFO  10:58:13,071 GenomeAnalysisEngine - Preparing for traversal over 1 BAM files 
INFO  10:58:13,100 GenomeAnalysisEngine - Done preparing for traversal 
INFO  10:58:13,101 ProgressMeter - [INITIALIZATION COMPLETE; STARTING PROCESSING] 
INFO  10:58:13,101 ProgressMeter -                 | processed |    time |    per 1M |           |   total | remaining 
INFO  10:58:13,101 ProgressMeter -        Location |     sites | elapsed |     sites | completed | runtime |   runtime 
INFO  10:58:13,128 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  10:58:13,128 StrandBiasTest - SAM/BAM data was found. Attempting to use read data to calculate strand bias annotations values. 
INFO  10:58:17,716 ProgressMeter -            done   3043210.0     4.0 s       1.0 s      100.0%     4.0 s       0.0 s 
INFO  10:58:17,717 ProgressMeter - Total runtime 4.62 secs, 0.08 min, 0.00 hours 
INFO  10:58:17,717 MicroScheduler - 0 reads were filtered out during the traversal out of approximately 5194 total reads (0.00%) 
INFO  10:58:17,718 MicroScheduler -   -> 0 reads (0.00% of total) failing BadCigarFilter 
INFO  10:58:17,718 MicroScheduler -   -> 0 reads (0.00% of total) failing BadMateFilter 
INFO  10:58:17,718 MicroScheduler -   -> 0 reads (0.00% of total) failing DuplicateReadFilter 
INFO  10:58:17,718 MicroScheduler -   -> 0 reads (0.00% of total) failing FailsVendorQualityCheckFilter 
INFO  10:58:17,719 MicroScheduler -   -> 0 reads (0.00% of total) failing MalformedReadFilter 
INFO  10:58:17,719 MicroScheduler -   -> 0 reads (0.00% of total) failing MappingQualityUnavailableFilter 
INFO  10:58:17,719 MicroScheduler -   -> 0 reads (0.00% of total) failing NotPrimaryAlignmentFilter 
INFO  10:58:17,719 MicroScheduler -   -> 0 reads (0.00% of total) failing UnmappedReadFilter 
INFO  10:58:18,707 GATKRunReport - Uploaded run statistics report to AWS S3 
INDELS found: 3
